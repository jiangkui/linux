# 每日签到

## 2017年06月27日08:20:34 周二
- 产出: 写了部分【检视阅读】的笔记。
- 收获: 带着问题读书, 效率才高。
- 结束: 2017年06月27日10:12:36

## 2017年06月28日09:09:37 周三
- 产出: 完成【检视阅读】的笔记
- 收获: 意识到一个重要的问题: 不读源码, 就学不会实现原理。不实践, 印象就不深。
- 结束: 2017年06月28日10:02:08
- 代办: 下一个任务时, 把源码搞定, 能编译。

## 2017年06月29日09:02:23 周四
- 产出: 第一章节, 记录部分笔记。
- 收获: [看了一篇帖子: 你有什么? 你要什么? 你能放弃什么?](http://www.mbajyz.cn/rw/newsdetail/58239.html)
- 结束: 2017年06月29日10:38:59
- 代办: 源码、源码
- 问题: fork() 系统调用是干啥的?

## 2017年06月30日09:46:00 周五
- 产出: 无, 今天遇到一些事情, 不看书了。

## 2017年07月03日08:57:47 周一
- 产出: 一点笔记
- 收获:
- 结束: 2017年07月03日10:45:45
- 代办:
- 问题:

## 2017年07月04日09:43:23 周二
- 产出: 第一章, 笔记搞定。
- 收获: 通过单内核与多内核的比较, 对 Linux 内核设计理念与实现, 有了一个粗略的了解。
- 结束: 2017年07月04日10:14:24
- 代办: (已完成) 今天抽空弄好 VMware 虚拟机, 在上面搞一份代码。
- 问题:

## 2017年07月05日08:27:28 周三
- 产出: 2.1 章节笔记, 安装好 mac 的 VMware, 安装了一个 ubuntu 系统, 正在下载 stable(4.12) 版本的linux内核
- 收获: 了解从何处获取源码: linux 内核官网, 了解源码的各种版本, 使用 git 或 压缩包+补丁 的方式下载更新源码
- 结束: 2017年07月05日10:31:31

## 2017年07月06日08:45:06 周四
- 产出: linux 源码目录树, 具体功能的笔记
- 收获: 慢慢来, 学会了才有正向反馈, 才能坚持下去。
- 结束: 2017年07月06日10:11:01
- 代办: 重新画一个 linux 的目录树图。

## 2017年07月07日08:39:00 周五
- 产出: 详细了解linux 各个目录的功能以及wiki。
- 收获: 还挺好玩的
- 结束: 2017年07月07日10:10:45
- 代办: 编译源码, 安装。

## 2017年07月08日20:00:55 周六
- 产出: 内核源码编译安装完毕
- 收获: 用了5个作业来编译, 可能因为是虚拟机的原因, 还是花了很久才编译完成。
- 结束: 2017年07月08日20:49:54

## 2017年07月10日08:16:17 周一
- 产出: 第二章完毕
- 收获: 了解了2.4 内核开发特定对应的内容。休息不好, 学习效率就很低。
- 结束: 2017年07月10日09:50:36

## 2017年07月11日08:55:08 周二
- 产出: 进程相关概念笔记。
- 收获: 了解进程的概念, 源码存放路径
- 结束: 2017年07月11日10:00:54

## 2017年07月12日08:12:04 周三
- 产出: 3.2 章节所有笔记。
- 收获: 了解 task_struct 源码中, pid、status、parent、children 字段对应的含义和功能。
- 结束: 2017年07月12日10:31:26

## 2017年07月13日08:48:22 周四
- 产出: 3.3 部分笔记
- 收获: 了解进程创建相关机制
- 结束: 2017年07月13日09:56:41 留一写时间处理工作问题

## 2017年07月19日09:02:36 周三
- 产出: 3.3 章节进程创建相关笔记。
- 收获: fork、vfork、clone 的区别, 写时拷贝(copy-on-write)的意义。搜这三者的区别时, 看了酷壳的文章, 写的很好, 收藏了这个网站。
- 结束: 2017年07月19日10:50:43
- 说明: 快一周没看了, 原因在于, 前一段时间玩了个游戏《魂斗罗归来》, 有点沉迷进去了。每天至少占用3个小时。学习时间减少, 工作效率降低, 工作时间变长。学习时间被占用了。

## 2017年07月21日08:29:20 周五
- 产出: 源码注释
- 收获: 直接看源码了, 还没看书, 把源码加上注释, 方便后期理解。
- 结束: 2017年07月21日10:14:08

## 2017年07月24日07:12:17 周一
- 产出: linux 进程相关概念笔记。
- 收获: 补充了解了之前不懂的 Linux 进程相关概念, 如程序计数器、进程栈、进程寄存器等相关概念。
- 结束: 2017年07月24日10:17:13
- 日记: 周天也看了一点源码, 但没深入, 最近的首要目标是恢复老年早, 这样才有更多的时间来看书。
- 问题: 1、task_struct 的堆栈是用来干嘛的?
    - 栈: 存放参数值、局部变量值, 由编译器分配和释放。
    - 堆: 由程序员分配和释放。
    - 全局区(静态区): 存放全局变量和静态变量, 有系统释放。
    - 文字常量区: 常量字符串。
    - 程序代码区: 存放函数体的二进制代码。
    - 总结: 栈是系统管理, 堆是程序员管理。栈用于存放局部变量、参数。
    - 参见: [Linux C 堆与栈的区别](http://blog.csdn.net/water_cow/article/details/7538689)
    - 附, 例子程序:
```
main()
{
    int b; //栈
    char s[] = "abc"; //栈
    char *p2; //栈
    char *p3 = "123456"; //123456在常量区，p3在栈上。
    static int c =0； //全局（静态）初始化区
    p1 = (char *)malloc(10);
    p2 = (char *)malloc(20); //分配得来得10和20字节的区域就在堆区。
    strcpy(p1, "123456"); //123456放在常量区，编译器可能会将它与p3所指向的"123456"优化成一个地方。
}
```

## 2017年07月25日07:01:12 周二
- 产出: 3.4、3.5、3.6 章节笔记
- 收获: 了解线程如何创建、进程如何终结的, 但只知道个大概, 细节需要再拿出时间来看。
- 结束: 2017年07月25日10:15:28

## 2017年07月26日07:00:02 周三
- 产出: 第4章进程调度相关笔记。
- 收获: 又回顾了下第三章 进程创建的相关细节, 现在脑子里有一个大概的流程图了。但细节方面还差很多。
- 结束: 2017年07月26日10:15:10

## 2017年07月28日06:56:41 周五
- 产出: 4.2 进程调度理论相关笔记。
- 收获: 大概了解了下进程调度的理论知识
- 结束: 2017年07月28日09:14:23

## 2017年07月31日07:20:42 周一
- 产出: 第四章、策略、调度算法、调度实现部分内容
- 收获: 大概了解了下进程调度的理论知识
- 结束: 2017年07月31日10:00:35

## 2017年08月01日06:42:56 周二
- 产出: linux 进程调度实现部分章节, 包括: 时间记账, 进程选择, 调度入口。
- 收获: 了解Linux 调度相关部分细节。
- 结束: 2017年08月01日09:40:12

## 2017年08月02日06:54:49 周三
- 产出: Linux 4.5章节进程调度实现:
    - 时间记账: vruntime存储运行时间, 系统定时器周期统计。
    - 进程选择:
        - CFS 如何选择下一个任务: 选择运行总数时间最小的, 使用红黑树实现, 即红黑树最左侧叶子节点, 有变量指向该节点, 不需要每次遍历树
        - 向树中加入进程的时机: fork()调用第一次创建进程时加入, 进程变为可运行时也会加入。
        - 从树种删除进程的时机: 进程阻塞, 进程终结。
    - 调度器入口: `kernel/sched.c schedule()`。该函数会变量所有调度器, 从最高优先级的调度器中, 选择最高优先级的进程。如果进程调用该函数, 意味着主动让出CPU(如: 进程阻塞)。
    - 休眠与唤醒:
        - 休眠: 把任务放入等待队列, 状态改为 TASK_INTERRUPTIBLE, 然后调用 schedule(), schdule 调用 deactivate_task() 从运行队列中任务。
        - 唤醒: 接受信号 或 等待事件发生, 状态改为 TASK_RUNNING, 然后把任务加入运行队列, 之后调用 schedule(), schdule 调用 _remove_wait_queue()把任务从等待队列删除。
- 收获: 了解Linux 调度实现的具体细节。
- 结束: 2017年08月02日10:05:21

## 2017年08月03日06:35:25
- 产出: 回顾了 4.5 章节之前的内容。 看了下 4.6 抢占和上下文切换的内容。效率不高。
- 收获: 今天收获较少, 效率不高, 可能是昨晚没睡好的原因。
- 结束: 2017年08月03日10:15:56